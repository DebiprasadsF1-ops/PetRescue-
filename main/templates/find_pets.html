{% extends 'base.html' %}
{% load static %}

{% block title %}Search Lost Pets | PetRescue{% endblock %}

{% block content %}
<div class="container mt-4">
  <!-- Hero Section -->
  <div class="row mb-5">
    <div class="col-12">
      <div class="hero-section position-relative overflow-hidden rounded-4 shadow-lg">
        <img src="https://images.unsplash.com/photo-1601758124096-3c28e9c67b05?auto=format&fit=crop&w=1500&q=80" 
             class="hero-bg" alt="Lost Pets">
        <div class="hero-overlay d-flex align-items-center justify-content-center text-center">
          <div class="hero-content animate__animated animate__fadeInDown">
            <h1 class="fw-bold display-4 mb-3 text-white text-glow">üêæ Find Your Lost Pet</h1>
            <p class="lead text-white-50 mb-4">Let‚Äôs help you reunite with your furry family members.</p>
            <div class="d-flex justify-content-center gap-3">
              <a href="#search-section" class="btn btn-lg btn-hero-gradient px-4 py-2 shadow-lg animate__animated animate__pulse animate__infinite">Search Found Pets</a>
              <a href="#available-pets-section" class="btn btn-lg btn-outline-light px-4 py-2 shadow">See All Pets</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Search Section -->
  <div class="row mb-5 fade-in-section" id="search-section">
    <div class="col-12">
      <div class="card border-0 rounded-4 shadow-lg bg-light search-card animate__animated animate__fadeInUp">
        <div class="card-header bg-search-gradient text-white text-center py-4 rounded-top-4">
          <h2 class="fw-bold mb-0">üîç Search Found Pets</h2>
          <p class="text-white-50 mb-0">Use filters to locate your pet faster</p>
        </div>
        <div class="card-body p-4">
          <form method="GET" id="pet-search-form">
            <div class="row g-3">
              <div class="col-md-4">
                <label class="form-label fw-semibold">Pet Type</label>
                {{ search_form.pet_type }}
              </div>
              <div class="col-md-4">
                <label class="form-label fw-semibold">Breed</label>
                {{ search_form.breed }}
              </div>
              <div class="col-md-4">
                <label class="form-label fw-semibold">Color</label>
                {{ search_form.color }}
              </div>
              <div class="col-md-6">
                <label class="form-label fw-semibold">Location</label>
                {{ search_form.location }}
              </div>
              <div class="col-md-3">
                <label class="form-label fw-semibold">From Date</label>
                {{ search_form.start_date }}
              </div>
              <div class="col-md-3">
                <label class="form-label fw-semibold">To Date</label>
                {{ search_form.end_date }}
              </div>
            </div>
            <div class="text-center mt-4">
              <button class="btn btn-lg btn-search-gradient rounded-pill px-5 shadow">Search</button>
              <a href="{% url 'find_pets' %}" class="btn btn-outline-secondary btn-lg rounded-pill px-5 ms-2">Clear</a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Search Results -->
  <div class="row mb-5 fade-in-section">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold gradient-text" id="search-results">Results</h2>
        <div class="text-muted">
          {% if pets %}
            {{ pets|length }} pet{{ pets|length|pluralize }} found
          {% else %}
            No pets found
          {% endif %}
        </div>
      </div>

      {% if pets %}
        <div class="row g-4">
          {% for pet in pets %}
            <div class="col-md-6 col-lg-4 animate__animated animate__zoomIn animate__delay-{{ forloop.counter }}00ms">
              <div class="card pet-card border-0 shadow rounded-4 overflow-hidden">
                {% if pet.image %}
                  <img src="{{ pet.image.url }}" alt="{{ pet.breed }}" class="pet-img">
                {% else %}
                  <div class="no-img text-center d-flex justify-content-center align-items-center">
                    <i class="fas fa-paw fa-3x text-muted"></i>
                  </div>
                {% endif %}
                <div class="card-body d-flex flex-column">
                  <h5 class="fw-bold text-gradient mb-1">{{ pet.breed }}</h5>
                  <small class="text-muted mb-2">
                    <i class="fas fa-map-marker-alt"></i> {{ pet.location }} <br>
                    <i class="fas fa-calendar"></i> {{ pet.created_at|date:"M d, Y" }}
                  </small>
                  <p class="flex-grow-1 text-secondary">{{ pet.description|truncatewords:20 }}</p>
                  <a href="#" class="btn btn-outline-primary mt-auto rounded-pill">View Details</a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="text-center py-5">
          <i class="fas fa-search fa-3x text-muted mb-3"></i>
          <h3>No Matches Found</h3>
          <p class="text-muted">Try different filters or check back later.</p>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- All Pets -->
  <div class="row mb-5 fade-in-section" id="available-pets-section">
    <div class="col-12">
      <h2 class="fw-bold mb-4 gradient-text">üê∂ All Found Pets</h2>
      {% if all_pets %}
        <div class="row g-4">
          {% for pet in all_pets %}
            <div class="col-md-6 col-lg-4 animate__animated animate__fadeInUp animate__delay-{{ forloop.counter }}00ms">
              <div class="card pet-card border-0 shadow rounded-4 overflow-hidden">
                {% if pet.image %}
                  <img src="{{ pet.image.url }}" alt="{{ pet.breed }}" class="pet-img">
                {% else %}
                  <div class="no-img text-center d-flex justify-content-center align-items-center">
                    <i class="fas fa-paw fa-3x text-muted"></i>
                  </div>
                {% endif %}
                <div class="card-body d-flex flex-column">
                  <h5 class="fw-bold text-gradient mb-1">{{ pet.breed }}</h5>
                  <small class="text-muted mb-2">
                    <i class="fas fa-map-marker-alt"></i> {{ pet.location }} <br>
                    <i class="fas fa-calendar"></i> {{ pet.created_at|date:"M d, Y" }}
                  </small>
                  <p class="flex-grow-1 text-secondary">{{ pet.description|truncatewords:20 }}</p>
                  <a href="#" class="btn btn-outline-primary mt-auto rounded-pill">View Details</a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="text-center py-5">
          <i class="fas fa-paw fa-3x text-muted mb-3"></i>
          <h3>No Pets Available</h3>
          <p class="text-muted">Check back later as new pets are added regularly.</p>
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<style>
  /* Background */
  body {
    background: linear-gradient(135deg, #f3f4ff 0%, #d1f3ff 100%);
    overflow-x: hidden;
  }

  /* Hero Section */
  .hero-section {
    position: relative;
    height: 480px;
    border-radius: 20px;
  }
  .hero-bg {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: brightness(60%);
  }
  .hero-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(0, 60, 120, 0.6));
  }
  .btn-hero-gradient {
    background: linear-gradient(90deg, #ff6a00, #ee0979);
    color: white;
    border: none;
    transition: all 0.4s ease;
  }
  .btn-hero-gradient:hover {
    transform: scale(1.1);
    box-shadow: 0 0 15px rgba(255, 100, 100, 0.5);
  }
  .text-glow {
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
  }

  /* Search Card */
  .bg-search-gradient {
    background: linear-gradient(90deg, #0072ff, #00c6ff);
  }
  .btn-search-gradient {
    background: linear-gradient(90deg, #00c9a7, #92fe9d);
    border: none;
    color: #fff;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .btn-search-gradient:hover {
    transform: scale(1.1);
    box-shadow: 0 0 15px rgba(0, 200, 150, 0.6);
  }

  /* Text Gradients */
  .gradient-text {
    background: linear-gradient(90deg, #0072ff, #00c6ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  .text-gradient {
    background: linear-gradient(90deg, #ff6a00, #ee0979);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  /* Pet Cards */
  .pet-card {
    transition: transform 0.4s ease, box-shadow 0.4s ease;
    background-color: #fff;
  }
  .pet-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
  }
  .pet-img {
    height: 250px;
    object-fit: cover;
    transition: transform 0.5s ease;
  }
  .pet-card:hover .pet-img {
    transform: scale(1.05);
  }

  /* Fade-In on Scroll */
  .fade-in-section {
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.8s ease-out;
  }
  .fade-in-section.visible {
    opacity: 1;
    transform: none;
  }
</style>

<script>
  // Scroll animation
  document.addEventListener("DOMContentLoaded", () => {
    const faders = document.querySelectorAll(".fade-in-section");
    const appear = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("visible");
          appear.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1 });
    faders.forEach(fader => appear.observe(fader));
  });
</script>
{% endblock %}
